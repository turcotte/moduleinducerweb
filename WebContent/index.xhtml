<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" 
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core">
	
	
<h:head>
	<title>Module Inducer</title>
	
	<style> 
    <!--
		* { 
		    
		    font-family: Verdana, Geneva, sans-serif; 
		    font-size: 10pt; 
		}
		
		.main {
			width: 770px;
		    margin: 25px 25px 25px 25px; 
		    font-size: 10pt;
		}
		
		.title{
			font-size: 13pt;
		}
		
		.header {
			border-style:solid; 
			border-width:1px; 
			border-color: #348017;  
			padding: 10px;
			margin: 0px;
			text-align: center; 
			font-size: 9pt;
		}
		
		.data-entry-title {
			font-size: 12pt;
		}
		
		.data-entry-area {
			margin: 0px 0px 25px 35px;
			padding: 0;
		}
		
		.info-message {
			background-color: #C3FDB8;
			padding: 4px;
			text-align: left; 
			/*vertical-align: top;*/ 
		}
		
		.text-entry-area {
			width: 720px;
			padding: 0;
			margin: 0;
		}
		
    -->
   </style>
   
	
	<!--  None of the below work, so had to include css in the page
	<style media="screen" type="text/css">
  		@import "#{facesContext.externalContext.request.contextPath}/css/mi_style.css"
	</style>
	<link href="${facesContext.externalContext.requestContextPath}/css/mi_style.css" rel="stylesheet" type="text/css"/>
	<link rel="stylesheet" type="text/css" href="${request.contextPath}/css/mi_style.css" />
	<link rel="stylesheet" type="text/css" href="mi_style.css" />
	<h:outputStylesheet library="css" name="/css/mi_style.css"  /> - placed in body
	-->
	
	
	<script language="javascript">
    <!--
    
    // If a specific value (expectedRadioValue) of a radiobutton (radioEL) is selected,
    // then display an element with a specified id (elementToDisplay).
    function radioToggle1(radioEL, expectedRadioValue, elementToDisplay) {
	    
    	var displayState;
    	
    	if (radioEL.value == expectedRadioValue){
    		displayState = 'block';
    	} else {
    		displayState = 'none'; 
    	}
    	
   
        if (document.all) { //IS IE 4 or 5 (or 6 beta)
            eval( "document.all." + elementToDisplay + ".style.display = "+ displayState);
        }
   
        if (document.layers) { //IS NETSCAPE 4 or below
            document.layers[elementToDisplay].display = displayState;
        }
       
        if (document.getElementById && !document.all) {
            document.getElementById(elementToDisplay).style.display = displayState;

        }
        
    }
   
   
    //-->
    </script>     
    

</h:head>

<h:body>


<div class="main">

<f:view>

	<div class="header">
		<div class="title">ModuleInducer</div>
		Extract patterns from biological data.
	</div>
	<br/>

	
	<div>
	
	<h:form id="dataSelectForm" >
		<h:outputLabel for="selectDataId" value="Select the kind of data you want to work with:  "></h:outputLabel>
		<h:selectOneMenu id="selectDataId" value="#{navigationBean.selectedData}">
			<f:selectItem itemValue="default" itemLabel=" -- "/>
			<f:selectItem itemValue="Celegans" itemLabel="Example C.elegans data"/>
			<f:selectItem itemValue="custom" itemLabel="Custom data"/>
		</h:selectOneMenu>
		&nbsp;
		<h:commandButton action="#{navigationBean.loadData}" styleClass="background-color: #348017" value=" Next >> "></h:commandButton>
	</h:form>
	
	<br/>
	
	<div style="text-align: left; background-color: #FFF380">
	<h:messages />	
	</div>
	
	
	
	
	<h:panelGroup rendered="#{navigationBean.customData==true}">
	
		<p class="info-message"> This version of Module Inducer is a 
		demonstration system, therefore the number and length of the input sequences is restricted to 150 and 3000 nt 
		respectively. The number of regulatory elements is restricted to 15. If you have any question or would like to 
		run Module Inducer on a larger data set, please write to us: Module.Inducer@site.uOttawa.ca
		</p>
		
		<h:form id="customDataFormId" name="customDataForm">
		
		
		<h:panelGrid columns="1">
			
				<h:outputLabel for="positiveSequencesTextArea" value="Positive sequences: " styleClass="data-entry-title" ></h:outputLabel><br/>

				<h:panelGroup>
				<div class="data-entry-area">
<!-- TODO: For now, all the validation is done by exceptions from MI. Better use validator. -->				
				<!-- 
					<h:inputTextarea id="positiveSequencesTextArea" value="#{customDataBean.posSequences}" styleClass="text-entry-area" rows="10" 
								validator="#{customDataBean.validateBioSequence}" required="true" />
				 -->
				 
				 	<h:inputTextarea id="positiveSequencesTextArea" value="#{customDataBean.posSequences}" styleClass="text-entry-area" rows="10" 
								 required="false" />
				 
				</div>
				</h:panelGroup>
			 
			 
				
                <h:outputLabel value="Negative sequences: " styleClass="data-entry-title" ></h:outputLabel><br/>
				
				<h:panelGroup>    
				
				<div class="data-entry-area">
                    <h:selectOneRadio id="negExRadioId" value="#{customDataBean.negExType}" onchange="radioToggle1(this, 'customNegEx', 'customNegExDiv');" >
                        <f:selectItem itemValue="customNegEx" itemLabel="Custom    " />   
                        <f:selectItem itemValue="mc0" itemLabel=" Same nucleotide composition   " />
                        <f:selectItem itemValue="mc1" itemLabel=" Markov chain of order 1 " />
                    </h:selectOneRadio>

					<div id="customNegExDiv" style="display: #{customDataBean.customNegExDivVisibility};" >
						<h:inputTextarea id="negativeSequencesTextArea" value="#{customDataBean.negSequences}" styleClass="text-entry-area" rows="10" 
										 required="false"   />	
					</div>
					
				</div>
                </h:panelGroup>
               
                
				
				<h:outputLabel value="Biological markers: " styleClass="data-entry-title"></h:outputLabel><br/>
				
				<h:panelGroup>
				<div class="data-entry-area">
					<h:selectOneRadio id="bioMarkersRadioId" value="#{customDataBean.bioMarkersType}" onchange="radioToggle1(this, 'customPSSMs', 'customPSSMsDiv');" >
                        <f:selectItem itemValue="useDreme" itemLabel=" Find new using DREME  " />   
                        <f:selectItem itemValue="customPSSMs" itemLabel=" Locate specified using PATSER " />
                    </h:selectOneRadio>
                    		
                    <div id="customPSSMsDiv" style="display: #{customDataBean.customPSSMsDivDivVisibility};">		
						<h:inputTextarea id="pwmSequencesTextArea" value="#{customDataBean.pwms}" styleClass="text-entry-area" rows="10" 
									 required="false" />
					</div>
				</div>
				</h:panelGroup>
			
			
		
			</h:panelGrid>
			
			<br/><br/>
			<h:commandButton action="#{customDataBean.induceTheory}" value=" Induce Theory >> "></h:commandButton>
			<br/><br/>
	
			
		</h:form>
		
		<h:panelGroup rendered="#{customDataBean.theoryInduced==true}">
				
				<h3> Resulting theory: </h3>
	
				<h:panelGrid columns="1">
	
					<h:panelGroup>				
					<form method="post" action="">
						<textarea name="theory" class="text-entry-area" rows="20" readonly="readonly">
								<h:outputText value="#{customDataBean.theory}"></h:outputText>
						</textarea><br/>				
					</form>
					</h:panelGroup>
			
					<h:panelGroup>	
						<p class="info-message">
						<b>How to read the theory </b>
						<br/><br/>
						The theory consists of several rules that describe positive examples. You can see how "strong" the rule is by the number of 
						positive and negative examples covered ([Pos cover = 12 Neg cover = 0]). In ideal case, when one rule describes all the data,
						then the positive cover will be the total number of positive sequences (in this case 16) and the negative cover will be 0.
						<br/><br/>
						Example of reading a rule.
						<br/><br/>&nbsp;&nbsp;has_crm(A) :-<br/> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;has_tfbs(A,m2), before(m7,m12,A).<br/><br/>
						Sequence A has cis-regulatory module if it has a transcription factor binding site (TFBS) m2 AND TFBS m7 is before m12.
						<br/><br/>
						<b>Description of possible theory rules:</b>
						<br/>&nbsp;&nbsp;<i>has_tfbs(A,m1)</i> - regulatory element m1 is located in A sequences
						<br/>&nbsp;&nbsp;<i>before(m1, m2, A)</i> - regulatory element m1 is located before m2 in A sequences
						<br/>&nbsp;&nbsp;<i>distance(m1, m2, A, 10)</i> - the distance between regulatory element m1 and m2 is exactly 10 nucleotides in A sequences
						<br/>&nbsp;&nbsp;<i>distance_interval(m1, m2, A, 10, 2)</i> - the distance between regulatory element m1 and m2 is 10 nucleotides in A sequences
						</p>
					</h:panelGroup>
		
				</h:panelGrid>
			</h:panelGroup>
		
		
	</h:panelGroup>




	<h:panelGroup rendered="#{navigationBean.cElegansData==true}">
	
	<p class="info-message">
				Data were extracted from the article: Zhao G., Schriefer L., Stormo G. <i>Identification of muscle-specific regulatory modules in 
				Caenorhabditis elegans.</i> <b>Genome Research</b>, 17: 348-357, 2007.
	</p>
			
	<h:form id="celegansForm">
		
		<h:panelGrid columns="1">
		
			<h:panelGroup>
				<br/>
				<h:outputLabel for="cElPosSeqTextId" value="Positive sequences: " styleClass="data-entry-title" ></h:outputLabel><br/>
				<h:inputTextarea id="cElPosSeqTextId" value="#{celegansDataBean.posSequences}" styleClass="text-entry-area" rows="10" readonly="true" />
				<br/>
			</h:panelGroup>
		
			
			
			<h:panelGroup >
				<br/><br/>
				<h:outputLabel for="cElNegSeqTextId" value="Negative sequences: " styleClass="data-entry-title" ></h:outputLabel><br/>
				<h:inputTextarea id="cElNegSeqTextId" value="#{celegansDataBean.negSequences}" styleClass="text-entry-area" rows="10" readonly="true" />
				

				<p class="info-message">
					Negative sequences were randomly generated using Markov Chain order 1 model based on the nucleotide composition of the positive sequences. 
				</p>
			</h:panelGroup>
			
			
			<h:panelGroup>	
				<br/><br/>	
				<h:outputLabel for="cElPwmTextId" value="Biological markers (PWMs): " styleClass="data-entry-title" ></h:outputLabel><br/>
				<h:inputTextarea id="cElPwmTextId" value="#{celegansDataBean.pwms}" styleClass="text-entry-area" rows="10" readonly="true" />
				<br/>
			</h:panelGroup>
		
	
		</h:panelGrid>
		
		<br/><br/>
		<h:commandButton action="#{celegansDataBean.induceTheory}" value=" Induce Theory >> "></h:commandButton>
		<br/><br/>
		
	</h:form>

	
		<h:panelGroup rendered="#{celegansDataBean.theoryInduced==true}">
			
			<h3> Resulting theory: </h3>

			<h:panelGrid columns="1">

				<h:panelGroup>		
				<h:inputTextarea id="cElTheoryTextId" value="#{celegansDataBean.theory}" styleClass="text-entry-area" rows="20" readonly="true" />
				</h:panelGroup>
		
				<h:panelGroup>	
					<p class="info-message">
					<b>How to read the theory </b>
					<br/><br/>
					The theory consists of several rules that describe positive examples. You can see how "strong" the rule is by the number of 
					positive and negative examples covered ([Pos cover = 12 Neg cover = 0]). In ideal case, when one rule describes all the data,
					then the positive cover will be the total number of positive sequences (in this case 16) and the negative cover will be 0.
					<br/><br/>
					Example of reading a rule.
					<i><br/><br/>&nbsp;&nbsp;has_crm(A) :-<br/> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;has_tfbs(A,m2), before(m7,m12,A).<br/><br/></i>
					Sequence A has cis-regulatory module if it has a transcription factor binding site (TFBS) m2 AND TFBS m7 is before m12.
					<br/><br/>
						<b>Description of possible theory rules:</b>
						<br/>&nbsp;&nbsp;<i>has_tfbs(A,m1)</i> - regulatory element m1 is located in A sequences
						<br/>&nbsp;&nbsp;<i>before(m1, m2, A)</i> - regulatory element m1 is located before m2 in A sequences
						<br/>&nbsp;&nbsp;<i>distance(m1, m2, A, 10)</i> - the distance between regulatory element m1 and m2 is exactly 10 nucleotides in A sequences
						<br/>&nbsp;&nbsp;<i>distance_interval(m1, m2, A, 10, 2)</i> - the distance between regulatory element m1 and m2 is 10 nucleotides in A sequences
					</p>
				</h:panelGroup>
	
			</h:panelGrid>
		</h:panelGroup>
	
	</h:panelGroup>
	
	
	</div>
	


</f:view>

</div>

</h:body>
</html>